import numpy as np
from .types.spectra import spectraType


def PMCorrect(xIn: list[float], yIn: list[float], spectrum: spectraType, enLambda: int) -> list[float]:
    exCorr = [0.0 for i in range(0, 220)]
    # Professional inverted exCorr/emCorr (with extrapolation for 600+ nm)
    exCorr += [0.605276138, 0.605884712, 0.619839229, 0.620140412, 0.632686135, 0.624850069, 0.628698093, 0.624304392,
               0.623162192, 0.62306964, 0.622439459, 0.623156612, 0.621963297, 0.622372325, 0.62563454, 0.626691749,
               0.624683328, 0.622464621, 0.621355846, 0.621842562, 0.626134734, 0.628922092, 0.632386375, 0.638411372,
               0.641552679, 0.644778974, 0.647492216, 0.648033581, 0.647832356, 0.645677123, 0.644779535, 0.645049357,
               0.648246721, 0.650607823, 0.654027337, 0.655703812, 0.657301901, 0.659546095, 0.66282908, 0.665243069,
               0.66832728, 0.670045291, 0.671976057, 0.674441921, 0.672825432, 0.673733947, 0.672865485, 0.671051861,
               0.668592759, 0.66621057, 0.664500322, 0.665295784, 0.666165989, 0.664993315, 0.664152307, 0.66169444,
               0.661145267, 0.660561237, 0.659317034, 0.658543677, 0.659185138, 0.660225233, 0.661703899, 0.664023962,
               0.664961989, 0.666279218, 0.668342479, 0.671280183, 0.67501247, 0.679911609, 0.685060377, 0.689635501,
               0.693984178, 0.698461578, 0.703137072, 0.70648067, 0.709471926, 0.71174506, 0.713241648, 0.712758843,
               0.712401083, 0.711771791, 0.710192249, 0.70807846, 0.704411394, 0.701364025, 0.699193474, 0.696095081,
               0.693434173, 0.690528422, 0.685841201, 0.681205406, 0.67589252, 0.670292441, 0.664027638, 0.658135946,
               0.652712427, 0.646999592, 0.641256595, 0.635416193, 0.629868488, 0.624486795, 0.618903798, 0.613059597,
               0.606915399, 0.601118743, 0.595508701, 0.589866475, 0.584375609, 0.578943093, 0.573335312, 0.568310574,
               0.563012252, 0.558535405, 0.554122877, 0.550647329, 0.547778626, 0.544998336, 0.542764397, 0.54053149,
               0.538521626, 0.537080903, 0.536090724, 0.535261144, 0.534860197, 0.535092809, 0.535402036, 0.536160377,
               0.536762612, 0.537967879, 0.53886272, 0.540359144, 0.54188865, 0.544179342, 0.546355463, 0.54877889,
               0.551075397, 0.552639535, 0.55401912, 0.555144359, 0.556275819, 0.557415399, 0.558435749, 0.559427063,
               0.56038528, 0.561233781, 0.56146064, 0.561793302, 0.56169378, 0.562053784, 0.561814408, 0.561628085,
               0.561066629, 0.560496657, 0.558747384, 0.556256149, 0.553218657, 0.549418871, 0.545276077, 0.541006689,
               0.536306043, 0.531571368, 0.52695483, 0.522939497, 0.519182309, 0.515443576, 0.512378546, 0.509524647,
               0.507039645, 0.505047421, 0.503175556, 0.501725274, 0.500805622, 0.500235727, 0.5, 0.5001803,
               0.50140718, 0.502386121, 0.503489843, 0.504712033, 0.505998117, 0.507620536, 0.509471182, 0.51127403,
               0.512956633, 0.514804669, 0.516194233, 0.517673623, 0.519333274, 0.521117371, 0.523258526, 0.525494098,
               0.528178397, 0.531230816, 0.534317283, 0.537685247, 0.540860106, 0.54380312, 0.546108274, 0.547857889,
               0.54887593, 0.549411035, 0.549180316, 0.548472556, 0.547111133, 0.545452018, 0.54353468, 0.541343814,
               0.539433237, 0.53764699, 0.53636682, 0.535455781, 0.534996334, 0.534803043, 0.534796788, 0.534915575,
               0.535250354, 0.535583629, 0.535916035, 0.536106198, 0.536104742, 0.53605057, 0.536039305, 0.535854067,
               0.535609338, 0.535274163, 0.534497878, 0.533558422, 0.532884318, 0.532301924, 0.53213463, 0.532022489,
               0.531723712, 0.531221567, 0.530449062, 0.529729139, 0.529146693, 0.528263906, 0.527351227, 0.526205133,
               0.525047455, 0.52409174, 0.522964399, 0.521872185, 0.520955113, 0.520166973, 0.519451553, 0.519148171,
               0.519200903, 0.519596766, 0.520313749, 0.521176242, 0.52247546, 0.524173409, 0.526399354, 0.529620917,
               0.532812874, 0.535966675, 0.539570064, 0.543249589, 0.547005384, 0.55045692, 0.553955852, 0.557732146,
               0.560787232, 0.563279441, 0.564962278, 0.566397854, 0.567749078, 0.568697384, 0.569498415, 0.570367361,
               0.571851118, 0.573369974, 0.57527573, 0.577433294, 0.579006164, 0.58071245, 0.582719127, 0.584879884,
               0.587252162, 0.590015849, 0.593056813, 0.595960566, 0.597936444, 0.599904487, 0.601602202, 0.60390336,
               0.606595684, 0.609185385, 0.611624965, 0.613998384, 0.616302974, 0.618251729, 0.620264251, 0.622501231,
               0.62533508, 0.628675537, 0.632063089, 0.6366136, 0.641640885, 0.645856982, 0.649317773, 0.652255698,
               0.655148369, 0.657550573, 0.658882806, 0.660531892, 0.661900926, 0.662352362, 0.662453671, 0.661903682,
               0.661943914, 0.661568639, 0.661669883, 0.661521368, 0.661320843, 0.661241841, 0.661130941, 0.661251674,
               0.660271949, 0.658468096, 0.657402353, 0.656633908, 0.657115971, 0.657285625, 0.657318054, 0.658716131,
               0.659997705, 0.662010949, 0.665590142, 0.66966324, 0.675284402, 0.680263076, 0.685458461, 0.690133277,
               0.695068098, 0.700783836, 0.705998977, 0.709852424, 0.714072807, 0.717999572, 0.722639326, 0.727425501,
               0.731944996, 0.735673168, 0.738833143, 0.741885264, 0.743615659, 0.745103756, 0.746453184, 0.747314963,
               0.748314882, 0.749584504, 0.750554412, 0.752264176, 0.753968126, 0.75661274, 0.75849305, 0.760984077,
               0.765676709, 0.770017338, 0.77547683, 0.781223694, 0.786356212, 0.79215086, 0.798353344, 0.804195729,
               0.810500329, 0.815172906, 0.819025661, 0.821952662, 0.825289457, 0.828587915, 0.832206524, 0.837016249,
               0.841430519, 0.846340686, 0.850182861, 0.854183581, 0.856880936, 0.859552078, 0.862196755, 0.864814723,
               0.867405748, 0.869969607, 0.872506088, 0.875014986, 0.87749611, 0.879949278, 0.882374319, 0.884771071,
               0.887139385, 0.889479123, 0.891790157, 0.894072368, 0.896325654, 0.89854992, 0.900745079, 0.902911064,
               0.90504781, 0.907155271, 0.909233407, 0.911282192, 0.913301611, 0.915291659, 0.917252344, 0.919183683,
               0.921085707, 0.922958456, 0.924801983, 0.926616352, 0.928401635, 0.930157919, 0.931885299, 0.933583882,
               0.935253786, 0.93689514, 0.938508082, 0.940092763, 0.941649341, 0.943177986, 0.944678878, 0.946152209,
               0.947598177, 0.949016993, 0.950408875, 0.951774053, 0.953112765, 0.954425259, 0.955711789, 0.956972623,
               0.958208034, 0.959418304, 0.960603725, 0.961764596, 0.962901224, 0.964013925, 0.965103021, 0.966168844,
               0.967211732, 0.968232029, 0.969230089, 0.97020627, 0.971160941, 0.972094471, 0.973007242, 0.973899638,
               0.974772051, 0.975624879, 0.976458524, 0.977273396, 0.978069909, 0.978848482, 0.979609541, 0.980353515,
               0.981080837, 0.981791949, 0.982487292, 0.983167314, 0.98383247, 0.984483215, 0.985120008, 0.985743314,
               0.986353601, 0.986951341, 0.987537006, 0.988111079, 0.988674037, 0.989226366, 0.989768555, 0.990301092,
               0.990824472, 0.99133919, 0.991845745, 0.992344637, 0.99283637, 0.993321451, 0.993800387, 0.994273689,
               0.994741871, 0.995205446, 0.995664932, 0.996120847, 0.996573714, 0.997024054, 0.997472392, 0.997919257,
               0.998365175, 0.998810679, 0.999256301, 0.999702575, 1.00015004, 1.00059923, 1.001050689, 1.001504957,
               1.001962581, 1.002424104, 1.002890077, 1.00336105, 1.003837575, 1.004320206, 1.004809503, 1.005306023,
               1.005810329, 1.006322987, 1.006844562, 1.007375625, 1.007916749, 1.008468508, 1.009031484, 1.009606256,
               1.010193411, 1.010793537, 1.011407227, 1.012035078, 1.012677687, 1.013335661, 1.014009608, 1.014700141,
               1.015407877, 1.016133439, 1.016877456, 1.017640558, 1.018423386, 1.019226583, 1.0200508, 1.020896694,
               1.021764926, 1.022656169, 1.023571099, 1.024510401, 1.025474767, 1.026464898, 1.027481503, 1.028525299,
               1.029597013, 1.030697383, 1.031827153, 1.032987082, 1.034177935, 1.035400494, 1.036655547, 1.037943897,
               1.039266359, 1.04062376, 1.042016944, 1.043446765, 1.044914095, 1.046419821, 1.047964841, 1.049550079,
               1.051176466, 1.05284496, 1.05455653, 1.056312169, 1.058112889, 1.059959722, 1.061853724, 1.063795971,
               1.065787564, 1.067829627, 1.069923312, 1.072069796, 1.074270281, 1.076526, 1.078838218, 1.081208226,
               1.083637351, 1.086126951, 1.088678419, 1.091293186, 1.093972717, 1.096718519, 1.09953214, 1.102415168,
               1.105369237, 1.108396026, 1.111497264, 1.114674725, 1.11793024, 1.121265691, 1.124683017, 1.128184219,
               1.131771352, 1.135446543, 1.139211981, 1.143069925, 1.147022709, 1.151072738, 1.155222505, 1.159474575,
               1.163831608, 1.168296351, 1.172871645, 1.177560433, 1.182365757, 1.187290771, 1.192338741, 1.197513054,
               1.202817218, 1.208254877, 1.213829805, 1.219545926, 1.22540731, 1.231418192, 1.237582967, 1.243906206,
               1.250392669, 1.257047304, 1.263875267, 1.270881924, 1.278072872, 1.285453945, 1.293031222, 1.300811061,
               1.308800083, 1.317005222, 1.325433711, 1.334093122, 1.342991375, 1.352136758, 1.361537961, 1.371204078,
               1.381144655, 1.391369705, 1.40188974, 1.412715801, 1.423859497, 1.435333039]
    emCorr = [0.0 for i in range(0, 220)]
    # Professional emCorr
    emCorr += [29.05115151, 25.85133844, 22.71669933, 20.28387154, 17.86487964, 16.48255059, 14.95007632,
               13.78020164, 12.71312998, 11.74955561, 10.89878067, 10.13086935, 9.492672752, 8.860764662,
               8.279207614, 7.763672827, 7.341249367, 6.96186991, 6.611846873, 6.285489693, 5.940675614,
               5.628905807, 5.3252899, 5.017516456, 4.7653321, 4.52578867, 4.301247461, 4.108928458,
               3.938850525, 3.805490171, 3.674448195, 3.559497294, 3.442928249, 3.329948828, 3.223626517,
               3.126674275, 3.038478891, 2.957028594, 2.883359071, 2.817889939, 2.750225929, 2.690542966,
               2.631384522, 2.576946519, 2.537414415, 2.485352962, 2.437530107, 2.39825001, 2.363660551,
               2.331426424, 2.298402657, 2.258831929, 2.215717593, 2.1740526, 2.134741509, 2.099279679,
               2.060152885, 2.024769732, 1.994319688, 1.961312133, 1.928427006, 1.896938771, 1.8668243,
               1.838039845, 1.81056955, 1.784360487, 1.759405385, 1.735646068, 1.713074073, 1.691636948,
               1.671318242, 1.652074445, 1.633880283, 1.61670071, 1.600502704, 1.58525837, 1.570927893,
               1.557489695, 1.544898358, 1.533137432, 1.522158041, 1.511943852, 1.502448732, 1.493651342,
               1.485511749, 1.478002532, 1.471089361, 1.464739811, 1.458923959, 1.453605686, 1.448758169,
               1.444342427, 1.440334261, 1.436693498, 1.433394984, 1.430400691, 1.427682605, 1.425205799,
               1.422939635, 1.420851212, 1.418908462, 1.417079557, 1.415331594, 1.413633104, 1.411951541,
               1.4102546, 1.408510691, 1.406686197, 1.404750838, 1.402670521, 1.400414847, 1.397949961,
               1.39524487, 1.392267147, 1.388983534, 1.385364228, 1.381373347, 1.376983951, 1.3721567,
               1.366868109, 1.361075861, 1.354665275, 1.347343098, 1.339366105, 1.330656812, 1.321488443,
               1.311703765, 1.301370844, 1.290592558, 1.279427916, 1.26769393, 1.255142648, 1.242429838,
               1.229828726, 1.217573917, 1.205783784, 1.194538199, 1.183931216, 1.173880225, 1.164362097,
               1.155048414, 1.145718994, 1.136874637, 1.128533936, 1.120617264, 1.113236078, 1.106236838,
               1.099633849, 1.093425204, 1.087470592, 1.081617548, 1.075526084, 1.069679715, 1.064229954,
               1.05921316, 1.054703005, 1.050750867, 1.04729905, 1.044353752, 1.041797314, 1.03945891,
               1.03719215, 1.035138178, 1.03331404, 1.031621869, 1.030103503, 1.028644503, 1.027236168,
               1.025789924, 1.024168561, 1.022317126, 1.020030219, 1.017651641, 1.015257089, 1.012851093,
               1.010563948, 1.008445603, 1.006523834, 1.004869451, 1.003421657, 1.00218987, 1.001108525,
               1.000348328, 1, 1.000040412, 1.000487803, 1.001321551, 1.002522582, 1.00396227, 1.005593288,
               1.007342919, 1.009009462, 1.01070068, 1.012382363, 1.014048548, 1.015775529, 1.01748761,
               1.019158682, 1.020776349, 1.022341206, 1.023883533, 1.025329777, 1.02683193, 1.028416098,
               1.030061184, 1.031816776, 1.033737591, 1.035782264, 1.037894529, 1.040082731, 1.042274985,
               1.044364839, 1.04648378, 1.048657079, 1.05089523, 1.053200971, 1.055507308, 1.057819487,
               1.060134884, 1.062425724, 1.064631092, 1.066588624, 1.068329076, 1.069839693, 1.071100925,
               1.072129103, 1.072900385, 1.073343366, 1.073443621, 1.073226065, 1.072704049, 1.07189438,
               1.070920323, 1.069835759, 1.068708519, 1.067631942, 1.066694959, 1.065943822, 1.065430389,
               1.065167295, 1.06517397, 1.065384493, 1.065903768, 1.06678818, 1.068036775, 1.069663741,
               1.071658347, 1.073986499, 1.076659405, 1.079657512, 1.082971404, 1.08651239, 1.090303953,
               1.094332265, 1.098609724, 1.103146701, 1.107914348, 1.112850437, 1.117946266, 1.123152006,
               1.128469922, 1.133792844, 1.139175609, 1.144620244, 1.150137358, 1.155727547, 1.161386043,
               1.167109269, 1.172895439, 1.17873549, 1.184617145, 1.190484733, 1.19640692, 1.202393002,
               1.208481127, 1.21466152, 1.220906882, 1.227210418, 1.233576301, 1.239998569, 1.246466971,
               1.252911889, 1.25936837, 1.26585072, 1.272388502, 1.278949411, 1.285558956, 1.292184595,
               1.298826684, 1.305471755, 1.312117778, 1.318740317, 1.325400884, 1.332093757, 1.33882728,
               1.345586433, 1.352383495, 1.359239565, 1.366164657, 1.373147923, 1.380167667, 1.387209941,
               1.394310152, 1.401505013, 1.408792858, 1.416156282, 1.423610662, 1.431094964, 1.438642924,
               1.446225454, 1.453843746, 1.461455721, 1.469107153, 1.476762878, 1.484444947, 1.492160514,
               1.499937832, 1.507765694, 1.515654234, 1.523604881, 1.531613702, 1.539682605, 1.547855935,
               1.556123202, 1.564471769, 1.572910697, 1.581424487, 1.590007301, 1.598679282, 1.607411464,
               1.616226735, 1.625102802, 1.634083297, 1.643121011, 1.652270306, 1.661507576, 1.670853804,
               1.68026667, 1.689801606, 1.699434054, 1.709146135, 1.718943688, 1.728850318, 1.738818458,
               1.74887553, 1.759040604, 1.769302597, 1.779671519, 1.790137953, 1.800717876, 1.811439657,
               1.822279693, 1.833244065, 1.844277101, 1.855429584, 1.866643936, 1.877937921, 1.889279946,
               1.900730333, 1.912230669, 1.923781906, 1.93538798, 1.947058665, 1.958780133, 1.970597803,
               1.982516561, 1.994510422, 2.006590829, 2.018762311, 2.031027253, 2.043395669, 2.055857783,
               2.068380216, 2.080935075, 2.093565273, 2.106247448, 2.119015213, 2.131881208, 2.144897404,
               2.158041395, 2.171343217, 2.184827906, 2.198532178, 2.212464616, 2.22664501, 2.241049753,
               2.2556593, 2.270502495, 2.285550491, 2.300807342, 2.316243245, 2.331863922, 2.347656259,
               2.363663651, 2.379888479, 2.396340758, 2.413031694, 2.430020175, 2.447325991, 2.464949619,
               2.482916091, 2.501274761, 2.520019192, 2.539127925, 2.558564961, 2.578282852, 2.598318555,
               2.618664202, 2.639266148, 2.660109135, 2.681146432, 2.702459341, 2.724085531, 2.746001876,
               2.768180481, 2.790651625, 2.813430328, 2.836591693, 2.860076829, 2.883959885, 2.908251113,
               2.932963625, 2.958037341, 2.983484419, 3.009293178, 3.035490559, 3.062132827, 3.089154896,
               3.11650169, 3.144191806, 3.172255523, 3.200769135, 3.229737411, 3.259057353, 3.288768063,
               3.318835207, 3.349261171, 3.380076948, 3.411218881, 3.442836935, 3.474860777, 3.507290645,
               3.540136552, 3.573444276, 3.607213099, 3.641458044, 3.676237761, 3.711489069, 3.747186217,
               3.78341194, 3.820221071, 3.857647468, 3.895634623, 3.934118165, 3.973152928, 4.012703391,
               4.052798162, 4.093487072, 4.13481208, 4.17695677, 4.220006018, 4.264182508, 4.309698906,
               4.356696835, 4.405320297, 4.455689458, 4.50774948, 4.561205201, 4.615771474, 4.671163628,
               4.726891473, 4.782302222, 4.836666317, 4.889191731, 4.939254762, 4.986102488, 5.029210864,
               5.068135002, 5.102702288, 5.13305768, 5.15951446, 5.182620034, 5.202798788, 5.220706371,
               5.237065667, 5.252522789, 5.267520241, 5.282599232, 5.298236121, 5.314881996, 5.332766213,
               5.351951718, 5.372535306, 5.394496473, 5.417847142, 5.442446167, 5.468151453, 5.49495966,
               5.522921334, 5.552178573, 5.582711825, 5.614652697, 5.647813316, 5.682416842, 5.718482347,
               5.75593783, 5.794696983, 5.834776019, 5.876133452, 5.918799801, 5.962730243, 6.007902842,
               6.05438245, 6.102067499, 6.150881697, 6.200707264, 6.251486027, 6.303368666, 6.356301298,
               6.410252929, 6.465280779, 6.521538867, 6.578960911, 6.637825862, 6.697968257, 6.759369977,
               6.821955681, 6.885891785, 6.951101518, 7.017668327, 7.085551205, 7.154834073, 7.225241797,
               7.296689502, 7.368995035, 7.442107851, 7.515823388, 7.590298525, 7.665372092, 7.741085097,
               7.817512879, 7.894787998, 7.972980074, 8.052222142, 8.132308688, 8.213429014, 8.295905463,
               8.379759969, 8.464869507, 8.551409554, 8.639256131, 8.72852082, 8.818816429, 8.910191595,
               9.002500406, 9.095647495, 9.189464062, 9.284328715, 9.379961074, 9.47641073, 9.573651935,
               9.671824877, 9.77083896, 9.870646496, 9.971032912, 10.07252845, 10.1751045, 10.27836815,
               10.38243573, 10.48753615, 10.59349774, 10.70057798, 10.80868437, 10.91789321, 11.02856976,
               11.14078553, 11.25447758, 11.3698519, 11.48666915, 11.60505232, 11.72496803, 11.84658606,
               11.96983486, 12.0947955, 12.22151473, 12.35049129, 12.48153636, 12.61469287, 12.75047388,
               12.88920937, 13.03115302, 13.17702674, 13.32755535, 13.48322996, 13.64529991, 13.81410183,
               13.98997332, 14.17453754, 14.36882825, 14.57432845, 14.7925058, 15.02538878, 15.27445081,
               15.54190251, 15.82920203, 16.1395814, 16.47490786, 16.83810254, 17.23213136, 17.66077276,
               18.12773464, 18.63770712, 19.19613953, 19.8066596, 20.47706649, 21.21215144, 22.02079696,
               22.91097193, 23.89170763, 24.97363369, 26.16768874, 27.48608359, 28.94323967, 30.55498606,
               32.3355973, 34.3111449, 36.49530261, 38.91982391, 41.60117681, 44.60452003, 47.89848291]
    cuvette_trans = [0.0 for i in range(0, 200)]
    cuvette_trans += reversed([0.937335415, 0.93838878, 0.937866809, 0.937962856, 0.937901484, 0.93733785, 0.937388706, 0.93705087,
                               0.938053665, 0.937996305, 0.936963876, 0.937496503, 0.938089644, 0.936885802, 0.937224121, 0.937803084,
                               0.937721252, 0.938121923, 0.937457517, 0.937671789, 0.93766243, 0.937977142, 0.937837118, 0.93695158,
                               0.937247531, 0.937332656, 0.936948344, 0.937446321, 0.937875392, 0.937619947, 0.937379246, 0.937824821,
                               0.93785984, 0.937389024, 0.937601954, 0.937265002, 0.937024676, 0.937377516, 0.937018909, 0.937255751,
                               0.937340158, 0.937196153, 0.937148177, 0.93753315, 0.937303371, 0.937770882, 0.937338206, 0.937386233,
                               0.937163849, 0.937361272, 0.937911765, 0.937471396, 0.937710158, 0.937394218, 0.937025636, 0.937519086,
                               0.937716351, 0.937250462, 0.937093703, 0.93788372, 0.937453117, 0.937517897, 0.937517211, 0.937185148,
                               0.937513676, 0.937209212, 0.937661006, 0.937432741, 0.937545039, 0.937261117, 0.9374683, 0.937411187,
                               0.936855272, 0.937497641, 0.937366982, 0.937606519, 0.93721728, 0.937250932, 0.937754396, 0.937073847,
                               0.937753468, 0.937591686, 0.93738493, 0.93721831, 0.937543157, 0.937108682, 0.937628975, 0.937283637,
                               0.937469056, 0.9374204, 0.937114747, 0.937379977, 0.93719244, 0.937532851, 0.93748469, 0.937329617,
                               0.937134361, 0.93733909, 0.937135824, 0.937421602, 0.93748455, 0.937305991, 0.937538433, 0.937505722,
                               0.937353764, 0.937156391, 0.937391599, 0.936952527, 0.937517306, 0.937130731, 0.937803141, 0.937141883,
                               0.937396844, 0.93741806, 0.937688046, 0.937325605, 0.936822586, 0.93737929, 0.93700187, 0.937019552,
                               0.937374681, 0.936886934, 0.937244097, 0.937240327, 0.93747249, 0.937367872, 0.937594458, 0.937176444,
                               0.937788474, 0.937107633, 0.936951599, 0.936858107, 0.937296054, 0.937567565, 0.937083823, 0.936831678,
                               0.936894608, 0.937381961, 0.937212346, 0.937420883, 0.936891734, 0.936955261, 0.936862984, 0.937087943,
                               0.937123903, 0.936982301, 0.937212982, 0.936707865, 0.937373015, 0.936902688, 0.936945858, 0.936807384,
                               0.937559312, 0.936520863, 0.937028917, 0.936844126, 0.937357381, 0.937132479, 0.936522128, 0.93705335,
                               0.936894061, 0.936800003, 0.936983433, 0.936897907, 0.936991336, 0.93668712, 0.936788279, 0.936631902,
                               0.937070338, 0.936997827, 0.936885312, 0.936688023, 0.936763897, 0.936581656, 0.936716379, 0.93649018,
                               0.937012107, 0.936400248, 0.936635316, 0.936652107, 0.936711718, 0.936696224, 0.936959985, 0.936476631,
                               0.936880608, 0.936555608, 0.936938407, 0.936613547, 0.936782678, 0.936891658, 0.937087657, 0.936711349,
                               0.936637033, 0.936660862, 0.936847547, 0.93634566, 0.936475474, 0.936087621, 0.936547241, 0.936440487,
                               0.936647428, 0.936379795, 0.93633824, 0.93652963, 0.936489296, 0.936187344, 0.936656488, 0.936281757,
                               0.936440283, 0.936318684, 0.93639651, 0.936470222, 0.936354574, 0.936504256, 0.936624953, 0.936449401,
                               0.936366622, 0.936302878, 0.9362662, 0.936198622, 0.936451575, 0.936078771, 0.935970624, 0.936209183,
                               0.936281935, 0.936113186, 0.936144314, 0.936232478, 0.935907707, 0.936161976, 0.936192468, 0.936108214,
                               0.936176039, 0.936077563, 0.935912247, 0.936043485, 0.936283048, 0.936174761, 0.936226107, 0.935944455,
                               0.936024914, 0.935952568, 0.936061776, 0.935912113, 0.935937748, 0.935725575, 0.935844504, 0.935916583,
                               0.935876776, 0.935719967, 0.935831687, 0.935829283, 0.935778631, 0.935823174, 0.935919533, 0.935752443,
                               0.935673548, 0.935647481, 0.935843487, 0.93552035, 0.935897026, 0.935657342, 0.935770747, 0.935746956,
                               0.93586436, 0.935596326, 0.935655257, 0.935647303, 0.935652364, 0.935651048, 0.93558485, 0.935528278,
                               0.935563068, 0.935439428, 0.93551829, 0.935542469, 0.935383345, 0.935436713, 0.935255642, 0.935433439,
                               0.935460409, 0.935458158, 0.935479959, 0.935518068, 0.935315558, 0.935448252, 0.93535841, 0.935482877,
                               0.935356121, 0.935244764, 0.93536157, 0.935412083, 0.935234801, 0.935292397, 0.935473512, 0.935303644,
                               0.935303357, 0.935265878, 0.935045338, 0.935194016, 0.935194105, 0.935107613, 0.934983247, 0.935002454,
                               0.935108776, 0.93518446, 0.935175215, 0.935206362, 0.935077833, 0.934934273, 0.934843985, 0.934966831,
                               0.934985606, 0.934945469, 0.934836229, 0.934994221, 0.934852721, 0.934844189, 0.934897874, 0.93494847,
                               0.934977347, 0.934907443, 0.93481308, 0.934744085, 0.934826775, 0.934679654, 0.934713999, 0.934554265,
                               0.9346558, 0.934642448, 0.934662215, 0.934634024, 0.934617748, 0.934460805, 0.934503193, 0.934508387,
                               0.934580027, 0.934477901, 0.934409968, 0.934390494, 0.934440358, 0.934388612, 0.934420732, 0.934527302,
                               0.934516888, 0.934431388, 0.934430911, 0.934457525, 0.934287345, 0.934256916, 0.934305325, 0.934156958,
                               0.934116166, 0.934098975, 0.934083055, 0.934133466, 0.933929628, 0.934181188, 0.933990199, 0.933949674,
                               0.93390871, 0.933970064, 0.933729083, 0.93380174, 0.933932311, 0.933950539, 0.93392683, 0.934039987,
                               0.933880603, 0.933917872, 0.933844757, 0.93377388, 0.933890343, 0.933727767, 0.933769849, 0.933814322,
                               0.93371212, 0.933734716, 0.933591048, 0.933710588, 0.93357645, 0.933530025, 0.933649572, 0.933431333,
                               0.933522148, 0.933413728, 0.93349659, 0.933345763, 0.933484955, 0.933323714, 0.933317833, 0.933434683,
                               0.933381468, 0.933351771, 0.933278058, 0.93326582, 0.933232409, 0.933139153, 0.933224894, 0.933245068,
                               0.933148613, 0.933164756, 0.933179588, 0.93311395, 0.932867711, 0.932952677, 0.932808711, 0.932799943,
                               0.932822717, 0.932665291, 0.932764721, 0.932872454, 0.932786764, 0.932668978, 0.932518272, 0.932562688,
                               0.932525311, 0.932396247, 0.932442379, 0.932603137, 0.932501628, 0.932623558, 0.932342275, 0.932236964,
                               0.932328548, 0.932227955, 0.932173195, 0.932449557, 0.932013092, 0.932237097, 0.932194964, 0.931936677,
                               0.932051709, 0.932030964, 0.931855443, 0.931493518, 0.931543878, 0.931952063, 0.931682472, 0.931602262,
                               0.931498432, 0.931364174, 0.931386528, 0.931308435, 0.931385072, 0.931444753, 0.931239611, 0.931240336,
                               0.93102417, 0.931051718, 0.931057396, 0.930904407, 0.93110417, 0.930826454, 0.930896695, 0.930723317,
                               0.930640297, 0.930654322, 0.930338446, 0.930319996, 0.930351893, 0.93029267, 0.930453332, 0.929856803,
                               0.930352758, 0.930031376, 0.929953632, 0.929905173, 0.929851487, 0.929606787, 0.929732691, 0.929753253,
                               0.929560769, 0.929606571, 0.929334933, 0.929329529, 0.929178759, 0.929193122, 0.929049606, 0.929217676,
                               0.929042276, 0.929011358, 0.928764184, 0.928960133, 0.928713926, 0.928664023, 0.928661919, 0.92854798,
                               0.928361944, 0.928420868, 0.928255895, 0.928220336, 0.92806867, 0.92815204, 0.92784146, 0.927737306,
                               0.927805055, 0.927774735, 0.927540251, 0.927421207, 0.927466106, 0.927265441, 0.927304096, 0.927142029,
                               0.927046299, 0.927013766, 0.926684628, 0.926682555, 0.926642208, 0.926576646, 0.926271502, 0.926295001,
                               0.926256491, 0.926053289, 0.92585612, 0.925773595, 0.925673326, 0.925475648, 0.925175641, 0.925022933,
                               0.92497729, 0.92488507, 0.924794916, 0.924560235, 0.924501597, 0.924165026, 0.924099089, 0.923936774,
                               0.92385273, 0.92353131, 0.923482348, 0.923295472, 0.923100217, 0.922959563, 0.92271745, 0.922601318,
                               0.922448883, 0.922131837, 0.921973953, 0.921740017, 0.921635602, 0.921269194, 0.921091474, 0.920977777,
                               0.920668557, 0.920659688, 0.920110168, 0.919802233, 0.919697425, 0.919510574, 0.919298312, 0.919007041,
                               0.918754355, 0.918510412, 0.918302962, 0.918079408, 0.917831453, 0.917613182, 0.917336286, 0.917016315,
                               0.916927967, 0.916774209, 0.916441218, 0.916278934, 0.915805925, 0.915810801, 0.915455011, 0.915166225,
                               0.914921837, 0.914692218, 0.914317792, 0.914042695, 0.913645789, 0.913221067, 0.91281182, 0.912494844,
                               0.912210312, 0.911836688, 0.911499786, 0.911089827, 0.910734736, 0.910267143, 0.909902922, 0.909536063,
                               0.909135818, 0.908790429, 0.908292166, 0.908006395, 0.90745093, 0.907089888, 0.906523991, 0.906083317,
                               0.905359879, 0.904773019, 0.904248155, 0.903374926, 0.9026043, 0.901881784, 0.900900478, 0.90003617,
                               0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183,
                               0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183,
                               0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183,
                               0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183,
                               0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183,
                               0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183, 0.898803183,
                               0.898803183, 0.898803183, 0.898803183, 0.898803183])
    xRound = np.round(xIn, 0)
    yCorr = []

    if spectrum == spectraType.emission:
        for x, y in zip(xRound, yIn):
            yCorr += [y * exCorr[enLambda] * emCorr[int(x)] * cuvette_trans[int(x)] * cuvette_trans[enLambda]]
    elif spectrum == spectraType.excitation:
        for x, y in zip(xRound, yIn):
            yCorr += [y * exCorr[int(x)] * emCorr[enLambda] * cuvette_trans[int(x)] * cuvette_trans[enLambda]]
    return yCorr
